#include <stdio.h>
#include <limits.h>

void lru_page_replacement() {
    int q[30], p[30], l, m, i, j, k = 0, x, c[30];
    int page_faults = 0;
    int c1;

    printf("Enter the number of frames (m): ");
    scanf("%d", &m);

    printf("Enter the length of reference string (l): ");
    scanf("%d", &l);

    printf("Enter the reference string: ");
    for (i = 0; i < l; i++) {
        scanf("%d", &q[i]);
    }

    for (i = 0; i < m; i++) {
        p[i] = -1;
        c[i] = 0;
    }

    printf("\nReference String\tFrames\t\tPage Faults\n");
    printf("--------------------------------------------------\n");

    for (i = 0; i < l; i++) {
        x = q[i];
        c1 = 0;

        for (j = 0; j < m; j++) {
            if (p[j] == x) {
                c1 = 1;
                c[j] = i + 1;
                break;
            }
        }

        printf("%d\t\t\t", x);

        if (c1 == 0) {
            page_faults++;

            if (k < m) {
                p[k] = x;
                c[k] = i + 1;
                k++;
            } else {
                int min = INT_MAX;
                int replace_index = -1;

                for (j = 0; j < m; j++) {
                    if (c[j] < min) {
                        min = c[j];
                        replace_index = j;
                    }
                }

                p[replace_index] = x;
                c[replace_index] = i + 1;
            }
        }

        for (j = 0; j < m; j++) {
            if (p[j] != -1) {
                printf("%d ", p[j]);
            } else {
                printf("- ");
            }
        }

        if (c1 == 0) {
            printf("\tFault");
        } else {
            printf("\tHit");
        }
        printf("\n");
    }

    printf("\nTOTAL number of page faults: %d\n", page_faults);
}

int main() {
    lru_page_replacement();
    return 0;
}
